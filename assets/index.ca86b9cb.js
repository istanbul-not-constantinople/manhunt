const pe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function l(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=l(o);fetch(o.href,r)}};pe();function E(){}function _e(t){return t&&typeof t=="object"&&typeof t.then=="function"}function de(t){return t()}function re(){return Object.create(null)}function T(t){t.forEach(de)}function be(t){return typeof t=="function"}function Y(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let G;function ie(t,e){return G||(G=document.createElement("a")),G.href=e,t===G.href}function ke(t){return Object.keys(t).length===0}function w(t,e){t.appendChild(e)}function a(t,e,l){t.insertBefore(e,l||null)}function f(t){t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function $(t){return document.createTextNode(t)}function N(){return $(" ")}function Q(){return $("")}function P(t,e,l,n){return t.addEventListener(e,l,n),()=>t.removeEventListener(e,l,n)}function y(t,e,l){l==null?t.removeAttribute(e):t.getAttribute(e)!==l&&t.setAttribute(e,l)}function ye(t){return Array.from(t.childNodes)}function q(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function he(t,e,l,n){l===null?t.style.removeProperty(e):t.style.setProperty(e,l,n?"important":"")}let W;function S(t){W=t}function we(){if(!W)throw new Error("Function called outside component initialization");return W}const B=[],ce=[],D=[],ue=[],ge=Promise.resolve();let V=!1;function ve(){V||(V=!0,ge.then(Z))}function X(t){D.push(t)}const U=new Set;let K=0;function Z(){const t=W;do{for(;K<B.length;){const e=B[K];K++,S(e),$e(e.$$)}for(S(null),B.length=0,K=0;ce.length;)ce.pop()();for(let e=0;e<D.length;e+=1){const l=D[e];U.has(l)||(U.add(l),l())}D.length=0}while(B.length);for(;ue.length;)ue.pop()();V=!1,U.clear(),S(t)}function $e(t){if(t.fragment!==null){t.update(),T(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(X)}}const H=new Set;let F;function Ce(){F={r:0,c:[],p:F}}function Ne(){F.r||T(F.c),F=F.p}function M(t,e){t&&t.i&&(H.delete(t),t.i(e))}function R(t,e,l,n){if(t&&t.o){if(H.has(t))return;H.add(t),F.c.push(()=>{H.delete(t),n&&(l&&t.d(1),n())}),t.o(e)}else n&&n()}function se(t,e){const l=e.token={};function n(o,r,s,m){if(e.token!==l)return;e.resolved=m;let d=e.ctx;s!==void 0&&(d=d.slice(),d[s]=m);const i=o&&(e.current=o)(d);let c=!1;e.block&&(e.blocks?e.blocks.forEach((u,p)=>{p!==r&&u&&(Ce(),R(u,1,1,()=>{e.blocks[p]===u&&(e.blocks[p]=null)}),Ne())}):e.block.d(1),i.c(),M(i,1),i.m(e.mount(),e.anchor),c=!0),e.block=i,e.blocks&&(e.blocks[r]=i),c&&Z()}if(_e(t)){const o=we();if(t.then(r=>{S(o),n(e.then,1,e.value,r),S(null)},r=>{if(S(o),n(e.catch,2,e.error,r),S(null),!e.hasCatch)throw r}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function Ee(t,e,l){const n=e.slice(),{resolved:o}=t;t.current===t.then&&(n[t.value]=o),t.current===t.catch&&(n[t.error]=o),t.block.p(n,l)}const Ie=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function me(t){t&&t.c()}function x(t,e,l,n){const{fragment:o,on_mount:r,on_destroy:s,after_update:m}=t.$$;o&&o.m(e,l),n||X(()=>{const d=r.map(de).filter(be);s?s.push(...d):T(d),t.$$.on_mount=[]}),m.forEach(X)}function ee(t,e){const l=t.$$;l.fragment!==null&&(T(l.on_destroy),l.fragment&&l.fragment.d(e),l.on_destroy=l.fragment=null,l.ctx=[])}function je(t,e){t.$$.dirty[0]===-1&&(B.push(t),ve(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function te(t,e,l,n,o,r,s,m=[-1]){const d=W;S(t);const i=t.$$={fragment:null,ctx:null,props:r,update:E,not_equal:o,bound:re(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:re(),dirty:m,skip_bound:!1,root:e.target||d.$$.root};s&&s(i.root);let c=!1;if(i.ctx=l?l(t,e.props||{},(u,p,...g)=>{const k=g.length?g[0]:p;return i.ctx&&o(i.ctx[u],i.ctx[u]=k)&&(!i.skip_bound&&i.bound[u]&&i.bound[u](k),c&&je(t,u)),p}):[],i.update(),c=!0,T(i.before_update),i.fragment=n?n(i.ctx):!1,e.target){if(e.hydrate){const u=ye(e.target);i.fragment&&i.fragment.l(u),u.forEach(f)}else i.fragment&&i.fragment.c();e.intro&&M(t.$$.fragment),x(t,e.target,e.anchor,e.customElement),Z()}S(d)}class ne{$destroy(){ee(this,1),this.$destroy=E}$on(e,l){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(l),()=>{const o=n.indexOf(l);o!==-1&&n.splice(o,1)}}$set(e){this.$$set&&!ke(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function fe(t){let e;return{c(){e=$("(you are admin)")},m(l,n){a(l,e,n)},d(l){l&&f(e)}}}function Oe(t){return{c:E,m:E,p:E,d:E}}function Le(t){let e;function l(r,s){return r[11].status===200?Ae:Se}let n=l(t),o=n(t);return{c(){o.c(),e=Q()},m(r,s){o.m(r,s),a(r,e,s)},p(r,s){n===(n=l(r))&&o?o.p(r,s):(o.d(1),o=n(r),o&&(o.c(),o.m(e.parentNode,e)))},d(r){o.d(r),r&&f(e)}}}function Se(t){let e,l,n;return{c(){e=h("h1"),e.textContent="this room does not exist!",l=N(),n=h("a"),n.textContent="take me back!",y(n,"href","/")},m(o,r){a(o,e,r),a(o,l,r),a(o,n,r)},p:E,d(o){o&&f(e),o&&f(l),o&&f(n)}}}function Ae(t){let e;function l(r,s){return r[1]!==void 0?Pe:Fe}let n=l(t),o=n(t);return{c(){o.c(),e=Q()},m(r,s){o.m(r,s),a(r,e,s)},p(r,s){n===(n=l(r))&&o?o.p(r,s):(o.d(1),o=n(r),o&&(o.c(),o.m(e.parentNode,e)))},d(r){o.d(r),r&&f(e)}}}function Fe(t){let e,l,n,o,r,s;function m(u,p){return u[2]?Je:qe}let d=m(t),i=d(t),c=t[2]&&ae(t);return{c(){e=h("h1"),l=$("waiting for "),n=h("span"),i.c(),o=$(" to start!"),r=N(),c&&c.c(),s=Q(),y(n,"class","blue svelte-wtcc1w")},m(u,p){a(u,e,p),w(e,l),w(e,n),i.m(n,null),w(e,o),a(u,r,p),c&&c.m(u,p),a(u,s,p)},p(u,p){d===(d=m(u))&&i?i.p(u,p):(i.d(1),i=d(u),i&&(i.c(),i.m(n,null))),u[2]?c?c.p(u,p):(c=ae(u),c.c(),c.m(s.parentNode,s)):c&&(c.d(1),c=null)},d(u){u&&f(e),i.d(),u&&f(r),c&&c.d(u),u&&f(s)}}}function Pe(t){let e,l,n,o=t[1].target+"",r,s,m,d,i,c=t[1].target+"",u,p,g,k,_,I,O,A=t[1].follower+"",J,b,C,le;function oe(v,j){return v[1].location!==void 0?Be:Te}let z=oe(t),L=z(t);return{c(){e=h("h1"),l=$("your target is "),n=h("span"),r=$(o),s=$("!"),m=N(),d=h("button"),i=$("i have found "),u=$(c),p=$("!"),g=N(),L.c(),k=N(),_=h("p"),I=$("you are being followed by "),O=h("span"),J=$(A),b=$("."),y(n,"class","blue svelte-wtcc1w"),y(O,"class","blue svelte-wtcc1w"),y(_,"class","svelte-wtcc1w")},m(v,j){a(v,e,j),w(e,l),w(e,n),w(n,r),w(e,s),a(v,m,j),a(v,d,j),w(d,i),w(d,u),w(d,p),a(v,g,j),L.m(v,j),a(v,k,j),a(v,_,j),w(_,I),w(_,O),w(O,J),w(_,b),C||(le=P(d,"click",t[7]),C=!0)},p(v,j){j&2&&o!==(o=v[1].target+"")&&q(r,o),j&2&&c!==(c=v[1].target+"")&&q(u,c),z===(z=oe(v))&&L?L.p(v,j):(L.d(1),L=z(v),L&&(L.c(),L.m(k.parentNode,k))),j&2&&A!==(A=v[1].follower+"")&&q(J,A)},d(v){v&&f(e),v&&f(m),v&&f(d),v&&f(g),L.d(v),v&&f(k),v&&f(_),C=!1,le()}}}function qe(t){let e;return{c(){e=$(t[3])},m(l,n){a(l,e,n)},p(l,n){n&8&&q(e,l[3])},d(l){l&&f(e)}}}function Je(t){let e;return{c(){e=$("you")},m(l,n){a(l,e,n)},p:E,d(l){l&&f(e)}}}function ae(t){let e,l,n;return{c(){e=h("button"),e.textContent="start!"},m(o,r){a(o,e,r),l||(n=P(e,"click",t[5]),l=!0)},p:E,d(o){o&&f(e),l=!1,n()}}}function Te(t){let e;return{c(){e=h("p"),e.textContent="they have not enabled location tracking",y(e,"class","svelte-wtcc1w")},m(l,n){a(l,e,n)},p:E,d(l){l&&f(e)}}}function Be(t){let e,l,n,o=t[1].location.latitude.toFixed(5)+"",r,s,m=t[1].location.longitude.toFixed(5)+"",d,i,c,u;function p(_,I){return _[4]?Me:We}let g=p(t),k=g(t);return{c(){e=h("p"),l=$("they are at "),n=h("a"),r=$(o),s=$("\xB0N "),d=$(m),i=$("\xB0W"),u=N(),k.c(),y(n,"class","mono svelte-wtcc1w"),y(n,"href",c="geo:"+t[1].location.latitude+", "+t[1].location.longitude),y(n,"target","_blank"),y(n,"title","open in maps app"),y(e,"class","svelte-wtcc1w")},m(_,I){a(_,e,I),w(e,l),w(e,n),w(n,r),w(n,s),w(n,d),w(n,i),w(e,u),k.m(e,null)},p(_,I){I&2&&o!==(o=_[1].location.latitude.toFixed(5)+"")&&q(r,o),I&2&&m!==(m=_[1].location.longitude.toFixed(5)+"")&&q(d,m),I&2&&c!==(c="geo:"+_[1].location.latitude+", "+_[1].location.longitude)&&y(n,"href",c),g===(g=p(_))&&k?k.p(_,I):(k.d(1),k=g(_),k&&(k.c(),k.m(e,null)))},d(_){_&&f(e),k.d()}}}function We(t){let e,l,n;return{c(){e=h("button"),e.textContent="open map"},m(o,r){a(o,e,r),l||(n=P(e,"click",t[9]),l=!0)},p:E,d(o){o&&f(e),l=!1,n()}}}function Me(t){let e,l,n,o,r,s,m,d;return{c(){e=h("button"),e.textContent="close map",l=N(),n=h("br"),o=N(),r=h("iframe"),y(r,"class","mt-4"),y(r,"width","425"),y(r,"height","350"),y(r,"frameborder","0"),y(r,"scrolling","no"),y(r,"marginheight","0"),y(r,"marginwidth","0"),ie(r.src,s="https://www.openstreetmap.org/export/embed.html?bbox="+(t[1].location.longitude-.005)+"%2C"+(t[1].location.latitude-.005)+"%2C"+(t[1].location.longitude+.005)+"%2C"+(t[1].location.latitude+.005)+"&layer=mapnik&marker="+t[1].location.latitude+"%2C"+t[1].location.longitude)||y(r,"src",s),he(r,"border","1px solid black"),y(r,"title","map marker with your target on")},m(i,c){a(i,e,c),a(i,l,c),a(i,n,c),a(i,o,c),a(i,r,c),m||(d=P(e,"click",t[8]),m=!0)},p(i,c){c&2&&!ie(r.src,s="https://www.openstreetmap.org/export/embed.html?bbox="+(i[1].location.longitude-.005)+"%2C"+(i[1].location.latitude-.005)+"%2C"+(i[1].location.longitude+.005)+"%2C"+(i[1].location.latitude+.005)+"&layer=mapnik&marker="+i[1].location.latitude+"%2C"+i[1].location.longitude)&&y(r,"src",s)},d(i){i&&f(e),i&&f(l),i&&f(n),i&&f(o),i&&f(r),m=!1,d()}}}function ze(t){let e;return{c(){e=h("h1"),e.textContent="verifying..."},m(l,n){a(l,e,n)},p:E,d(l){l&&f(e)}}}function Ge(t){let e,l,n,o,r,s,m,d,i,c=t[2]&&fe(),u={ctx:t,current:null,token:null,hasCatch:!1,pending:ze,then:Le,catch:Oe,value:11};return se(i=fetch(document.location.origin+"/api/roominfo?id="+t[0]),u),{c(){e=h("p"),l=$("room id is "),n=h("span"),o=$("#"),r=$(t[0]),s=N(),c&&c.c(),m=N(),d=Q(),u.block.c(),y(n,"class","blue mono svelte-wtcc1w"),y(e,"class","absolute top-0 left-0 m-5 small svelte-wtcc1w")},m(p,g){a(p,e,g),w(e,l),w(e,n),w(n,o),w(n,r),w(e,s),c&&c.m(e,null),a(p,m,g),a(p,d,g),u.block.m(p,u.anchor=g),u.mount=()=>d.parentNode,u.anchor=d},p(p,[g]){t=p,g&1&&q(r,t[0]),t[2]?c||(c=fe(),c.c(),c.m(e,null)):c&&(c.d(1),c=null),u.ctx=t,g&1&&i!==(i=fetch(document.location.origin+"/api/roominfo?id="+t[0]))&&se(i,u)||Ee(u,t,g)},i:E,o:E,d(p){p&&f(e),c&&c.d(),p&&f(m),p&&f(d),u.block.d(p),u.token=null,u=null}}}function Ke(t,e,l){let{gameId:n}=e,o;const r=new WebSocket("ws:mmmanhunt-ghpages.herokuapp.com/api/play");let s=!1,m;r.addEventListener("message",k=>{const _=JSON.parse(k.data);console.log(_),_.type==="player"?_.admin===!0?l(2,s=!0):l(3,m=_.admin):_.type==="started"?l(1,o={follower:_.follower,target:_.target}):_.type==="location"?l(1,o.location=_.location,o):_.type==="newtarget"?l(1,o.target=_.target,o):_.type==="newfollower"&&l(1,o.follower=_.follower,o)}),r.addEventListener("close",k=>{console.log(k.code,k.reason)});const d=()=>{r.send(JSON.stringify({type:"start"}))},i=()=>{r.send(JSON.stringify({type:"found"}))};navigator.geolocation.watchPosition(k=>r.send(JSON.stringify({type:"location",location:{latitude:k.coords.latitude,longitude:k.coords.longitude}})));let c=!1;const u=()=>confirm("press ok if you really have.")&&i(),p=()=>l(4,c=!1),g=()=>l(4,c=!0);return t.$$set=k=>{"gameId"in k&&l(0,n=k.gameId)},[n,o,s,m,c,d,i,u,p,g]}class De extends ne{constructor(e){super(),te(this,e,Ke,Ge,Y,{gameId:0})}}function He(t){let e,l,n,o,r,s,m,d,i,c,u,p,g,k,_,I,O,A,J;return{c(){e=h("h1"),e.textContent="manhunt game",l=N(),n=h("input"),o=N(),r=h("br"),s=N(),m=h("br"),d=N(),i=h("button"),i.textContent="join room",c=N(),u=h("input"),p=N(),g=h("br"),k=N(),_=h("br"),I=N(),O=h("button"),O.textContent="create room",y(n,"id","name"),y(n,"class","w-50"),y(n,"type","text"),y(n,"placeholder","enter name"),y(u,"id","roomid"),y(u,"class","w-24"),y(u,"type","text"),y(u,"placeholder","enter room id")},m(b,C){a(b,e,C),a(b,l,C),a(b,n,C),a(b,o,C),a(b,r,C),a(b,s,C),a(b,m,C),a(b,d,C),a(b,i,C),a(b,c,C),a(b,u,C),a(b,p,C),a(b,g,C),a(b,k,C),a(b,_,C),a(b,I,C),a(b,O,C),A||(J=[P(i,"click",t[0]),P(u,"keyup",t[2]),P(O,"click",t[1])],A=!0)},p:E,i:E,o:E,d(b){b&&f(e),b&&f(l),b&&f(n),b&&f(o),b&&f(r),b&&f(s),b&&f(m),b&&f(d),b&&f(i),b&&f(c),b&&f(u),b&&f(p),b&&f(g),b&&f(k),b&&f(_),b&&f(I),b&&f(O),A=!1,T(J)}}}function Qe(t){const e=async r=>{const s=document.getElementById("name").value;if(s.length<3){alert(`the name "${s}" is too short`);return}const m=await fetch(`http://mmmanhunt-ghpages.herokuapp.com/api/joinroom?id=${r}&name=${s}`);m.status===200?document.location=document.location.origin+document.location.pathname+"/"+r:m.status===404?alert(`couldn't find room ${r}.`):m.status===400?alert("bad request."):alert("connection error.")},l=async()=>{const r=document.getElementById("roomid").value,s=parseInt(r.replace("#",""));if(isNaN(s)){alert(`invalid room id "${r}"`);return}e(s)};return[l,async()=>{const r=await fetch("http://mmmanhunt-ghpages.herokuapp.com/api/newroom");if(r.status===200){const{id:s}=await r.json();e(s)}else r.status===400?alert("bad request."):alert("connection error.")},r=>r.key==="Enter"&&l()]}class Re extends ne{constructor(e){super(),te(this,e,Qe,He,Y,{})}}const{document:Ue}=Ie;function Ve(t){let e,l;return e=new Re({}),{c(){me(e.$$.fragment)},m(n,o){x(e,n,o),l=!0},p:E,i(n){l||(M(e.$$.fragment,n),l=!0)},o(n){R(e.$$.fragment,n),l=!1},d(n){ee(e,n)}}}function Xe(t){let e,l;return e=new De({props:{gameId:t[0]}}),{c(){me(e.$$.fragment)},m(n,o){x(e,n,o),l=!0},p:E,i(n){l||(M(e.$$.fragment,n),l=!0)},o(n){R(e.$$.fragment,n),l=!1},d(n){ee(e,n)}}}function Ye(t){let e,l,n,o,r,s;const m=[Xe,Ve],d=[];function i(c,u){return isNaN(parseInt(c[0]))?1:0}return n=i(t),o=d[n]=m[n](t),{c(){e=h("div"),l=h("div"),o.c(),r=N(),y(l,"class","text-center"),y(e,"class","flex flex-col items-center justify-center h-[100vh] w-full"),Ue.title="london lmao"},m(c,u){a(c,e,u),w(e,l),d[n].m(l,null),a(c,r,u),s=!0},p(c,[u]){o.p(c,u)},i(c){s||(M(o),s=!0)},o(c){R(o),s=!1},d(c){c&&f(e),d[n].d(),c&&f(r)}}}function Ze(t){return[document.location.pathname.split("/").slice(-1)[0]]}class xe extends ne{constructor(e){super(),te(this,e,Ze,Ye,Y,{})}}new xe({target:document.body,props:{}});
